# TIP Data Model

## Overview

This document describes the core entities and relationships in the TIP (Travel Intelligence & Planner) system.

## Entities

### User
A traveler who creates an account to generate travel intelligence reports. Authenticates via email/password or Google OAuth and owns all trips, profiles, and notifications.

### Trip
A planned journey with destination(s), dates, budget, lead traveler details, and companion count. Represents a single travel intelligence report generation request. Tracks status (pending, processing, completed, failed) and auto-deletion schedule.

### Destination
A country or city the user plans to visit within a trip. Can be multiple destinations for multi-city trips. Stored as cities array within Trip entity.

### AgentJobs
Background processing jobs executed by specialized AI agents (visa, country, weather, currency, culture, food, attractions, itinerary, flight) to generate travel intelligence. Tracks execution status, timing, retry attempts, confidence scores, and agent-specific result data.

### ReportSections
Generated intelligence sections for a trip report. Each section type (visa, country, weather, currency, culture, food, attractions, itinerary, flight, summary) contains structured content, source references, and confidence scores.

### VisaRequirement
Visa and entry requirements determined by traveler's nationality, residency country, residency status, and destination. Includes visa type, stay duration, processing times, and official sources.

### Itinerary
Day-by-day travel plan for a trip with weather-aware scheduling and budget alignment. Generated by AI based on trip preferences and destination intelligence.

### ItineraryItem
Individual activity, meal, or attraction within a day's schedule. Includes embedded point-of-interest details: name, location, cost estimate, visit duration, and category.

### TravelReport
Complete generated intelligence report for a trip. Logical grouping of all ReportSections for a single trip with overall metadata and presentation structure.

### TravelerProfile
Saved traveler preferences, nationality, residency information, and travel style preferences for quick trip creation.

### SourceReference
Official government or embassy source used for critical data (visa requirements, laws, safety). Includes URL, source type, credibility rating, and last verification date.

### FlightOption
Flight search results with pricing, airline, route (direct/transit), and booking aggregator links.

### Notification
System notifications for users including deletion reminders and report completion alerts.

### DeletionSchedule
Automated data lifecycle management tracking scheduled deletions for trips (7 days after trip end date).

## Relationships

```
User
├── has many Trip
├── has one TravelerProfile
├── has many Notification
└── has many DeletionSchedule (via Trips)

Trip
├── belongs to User (lead traveler)
├── has many Destination (stored as cities array)
├── has many AgentJobs
├── has many ReportSections
├── has one TravelReport (logical grouping)
├── has one DeletionSchedule
└── has many SourceReference

ReportSections
├── belongs to Trip
└── contains VisaRequirement, Itinerary, FlightOption (as section types)

Itinerary (within ReportSections)
└── has many ItineraryItem (as structured content)

TravelReport
└── aggregates all ReportSections for a Trip
```

## Status Enums

### Trip Status
- `draft` — Trip is being created, not yet submitted
- `pending` — Submitted for processing
- `processing` — AI agents are generating intelligence
- `completed` — Report ready for viewing
- `failed` — Generation failed, can retry

### Agent Job Status
- `queued` — Job waiting to be processed
- `running` — Agent is executing
- `completed` — Job finished successfully
- `failed` — Job failed, may retry
- `skipped` — Job skipped (not applicable)

### Confidence Levels (Visa)
- `high` — Official government sources
- `medium` — Third-party verified sources
- `low` — Uncertain, requires verification
